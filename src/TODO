possible improvements:
- dynamic bit strength

limiter:
- flush
- allow processing multiple blocks in inner loop
- interpolate scale factor directly
